# Phase 7-04: 测试记录与数据分析模板

**文档类型**: 数据记录与分析  
**版本**: V1.0  
**最后更新**: 2025-12-02

---

## 📋 文档说明

本文档提供Phase 7硬件验证测试的所有数据记录表格模板和数据分析方法。请根据实际测试情况填写相应表格。

**使用建议**:
1. 打印此文档或复制到Excel中使用
2. 每个测试项完成后立即填写，避免遗忘
3. 异常情况必须详细记录并拍照
4. 测试完成后汇总所有数据生成总结报告

---

## 📝 测试环境记录表

### 基本信息

| 项目 | 内容 |
|------|------|
| 测试日期 | ___年___月___日 |
| 测试人员 | ________________ |
| 固件版本 | STM32_485 V_____ |
| 编译日期 | ___年___月___日 |
| 开发板型号 | 正点原子M48Z-M3 |
| 电机型号 | 张大头Y57系列 |
| 测试地点 | ________________ |

### 硬件配置

| 设备名称 | 型号/规格 | 序列号 | 状态 |
|----------|-----------|--------|------|
| STM32开发板 | | | ☐正常 ☐异常 |
| 步进电机1 | | 地址:___ | ☐正常 ☐异常 |
| 步进电机2 | | 地址:___ | ☐正常 ☐异常 |
| 步进电机3 | | 地址:___ | ☐正常 ☐异常 |
| RS485模块 | | | ☐正常 ☐异常 |
| 稳压电源 | 24V/___A | | ☐正常 ☐异常 |
| USB转TTL | | | ☐正常 ☐异常 |
| 示波器 | | | ☐正常 ☐异常 |

### 环境条件

| 时间点 | 环境温度(°C) | 湿度(%RH) | 电源电压(V) | 备注 |
|--------|--------------|-----------|-------------|------|
| 测试开始 | | | | |
| 测试中期 | | | | |
| 测试结束 | | | | |

---

## 📊 T7.1: 长时间运行测试记录

### 48小时测试主记录表

| 时间点 | 运行时长 | 循环次数 | 成功次数 | 失败次数 | 看门狗复位 | 通信成功率(%) | STM32温度 | 电机温度 | 备注 |
|--------|----------|----------|----------|----------|------------|---------------|-----------|----------|------|
| Day1 10:00 | 0h | 0 | 0 | 0 | 0 | - | | | 测试启动 |
| Day1 11:00 | 1h | | | | | | | | |
| Day1 13:00 | 3h | | | | | | | | |
| Day1 16:00 | 6h | | | | | | | | |
| Day1 19:00 | 9h | | | | | | | | |
| Day1 22:00 | 12h | | | | | | | | 睡前检查 |
| Day2 07:00 | 21h | | | | | | | | 起床检查 |
| Day2 10:00 | 24h | | | | | | | | 中期检查 |
| Day2 16:00 | 30h | | | | | | | | |
| Day2 22:00 | 36h | | | | | | | | 睡前检查 |
| Day3 07:00 | 45h | | | | | | | | 起床检查 |
| Day3 10:00 | 48h | | | | | | | | 测试完成 |

### 异常事件记录表

| 序号 | 发生时间 | 运行时长 | 异常类型 | 详细描述 | 处理措施 | 结果 |
|------|----------|----------|----------|----------|----------|------|
| 1 | | | ☐通信超时<br>☐看门狗复位<br>☐电机失步<br>☐系统崩溃<br>☐其他:___ | | | ☐已恢复<br>☐未恢复 |
| 2 | | | ☐通信超时<br>☐看门狗复位<br>☐电机失步<br>☐系统崩溃<br>☐其他:___ | | | ☐已恢复<br>☐未恢复 |
| 3 | | | ☐通信超时<br>☐看门狗复位<br>☐电机失步<br>☐系统崩溃<br>☐其他:___ | | | ☐已恢复<br>☐未恢复 |

### 性能指标汇总

| 指标项 | 目标值 | 实测值 | 达标情况 |
|--------|--------|--------|----------|
| 总运行时间 | 48小时 | _____小时 | ☐达标 ☐不达标 |
| 总循环次数 | >80000次 | _____次 | ☐达标 ☐不达标 |
| 系统崩溃次数 | 0次 | _____次 | ☐达标 ☐不达标 |
| 看门狗复位次数 | ≤5次 | _____次 | ☐达标 ☐不达标 |
| 通信成功率 | ≥99.9% | _____%  | ☐达标 ☐不达标 |
| 电机失步次数 | 0次 | _____次 | ☐达标 ☐不达标 |
| 平均响应延迟 | <10ms | _____ms | ☐达标 ☐不达标 |
| 最大响应延迟 | <50ms | _____ms | ☐达标 ☐不达标 |

**测试结论**: ☐通过 ☐不通过

**签字**: __________ 日期: __________

---

## ⚠️ T7.2: 故障注入测试记录

### T7.2.1 电源跌落恢复测试

| 测试电压(V) | 电流(A) | 电机状态 | STM32状态 | 日志输出 | 恢复时间 | 结果 |
|-------------|---------|----------|-----------|----------|----------|------|
| 24.0 (基线) | | ☐正常运行<br>☐停止 | ☐正常<br>☐复位 | | - | ☐Pass<br>☐Fail |
| 23.0 | | ☐正常运行<br>☐停止 | ☐正常<br>☐复位 | | | ☐Pass<br>☐Fail |
| 22.0 | | ☐正常运行<br>☐停止 | ☐正常<br>☐复位 | | | ☐Pass<br>☐Fail |
| 21.0 (临界) | | ☐正常运行<br>☐停止 | ☐正常<br>☐复位 | | | ☐Pass<br>☐Fail |
| 20.0 (低压) | | ☐正常运行<br>☐停止 | ☐正常<br>☐复位 | | | ☐Pass<br>☐Fail |
| 10.0 (1秒) | | ☐正常运行<br>☐停止 | ☐正常<br>☐复位 | | | ☐Pass<br>☐Fail |

**验收结论**: ☐通过 ☐不通过  
**备注**: _______________________________________________

### T7.2.2 RS485通信断线重连测试

| 故障类型 | 持续时间 | 检测时间 | 恢复时间 | 自动恢复 | 重试次数 | 最终结果 |
|----------|----------|----------|----------|----------|----------|----------|
| A线断开 | | | | ☐是 ☐否 | | ☐Pass<br>☐Fail |
| B线断开 | | | | ☐是 ☐否 | | ☐Pass<br>☐Fail |
| A-B短接(<1s) | | | | ☐是 ☐否 | | ☐Pass<br>☐Fail |
| 线缆抖动(2min) | | | | ☐是 ☐否 | | ☐Pass<br>☐Fail |

**RS485模块状态检查**:
- [ ] 模块无发热异常
- [ ] 模块无烧毁痕迹
- [ ] 指示灯工作正常
- [ ] 通信功能完全恢复

**验收结论**: ☐通过 ☐不通过  
**备注**: _______________________________________________

### T7.2.3 通信超时与重试机制测试

| 测试场景 | 超时检测时间 | 重试次数 | 重试成功 | 最终失败 | 结果 |
|----------|--------------|----------|----------|----------|------|
| 单次超时注入 | | | | | ☐Pass<br>☐Fail |
| 间歇性超时(10%) | | | | | ☐Pass<br>☐Fail |
| 极限超时(20ms) | | | | | ☐Pass<br>☐Fail |

**统计数据**:
- 总命令数: ___________
- 首次失败数: ___________
- 重试成功数: ___________
- 最终失败数: ___________
- 整体成功率: ___________%

**验收结论**: ☐通过 ☐不通过  
**备注**: _______________________________________________

### T7.2.4 电机堵转保护测试

| 测试轮次 | 堵转时间 | 检测延迟 | 最大电流(A) | 最高温度(°C) | 保护动作 | 恢复状态 | 结果 |
|----------|----------|----------|-------------|--------------|----------|----------|------|
| 1 | | | | | ☐正常停止<br>☐强制断电<br>☐无保护 | ☐完全恢复<br>☐部分恢复<br>☐未恢复 | ☐Pass<br>☐Fail |
| 2 | | | | | ☐正常停止<br>☐强制断电<br>☐无保护 | ☐完全恢复<br>☐部分恢复<br>☐未恢复 | ☐Pass<br>☐Fail |
| 3 | | | | | ☐正常停止<br>☐强制断电<br>☐无保护 | ☐完全恢复<br>☐部分恢复<br>☐未恢复 | ☐Pass<br>☐Fail |

**⚠️ 安全检查**:
- [ ] 电机无永久损坏
- [ ] 轴承运转正常
- [ ] 无异常噪音或振动
- [ ] 电机驱动器工作正常
- [ ] 温度已降至安全范围

**验收结论**: ☐通过 ☐不通过  
**备注**: _______________________________________________

### T7.2.5 看门狗复位测试

| 测试次数 | 触发方式 | 复位延迟 | 恢复时间 | 计数器值 | 结果 |
|----------|----------|----------|----------|----------|------|
| 1 | ☐inject_fault(3)<br>☐注释喂狗 | | | | ☐Pass<br>☐Fail |
| 2 | ☐inject_fault(3)<br>☐注释喂狗 | | | | ☐Pass<br>☐Fail |
| 3 | ☐inject_fault(3)<br>☐注释喂狗 | | | | ☐Pass<br>☐Fail |

**看门狗参数验证**:
- 配置超时时间: _____秒
- 实测超时时间: _____秒
- 误差: _____%

**验收结论**: ☐通过 ☐不通过  
**备注**: _______________________________________________

---

## 📡 T7.3: 通信压力测试记录

### T7.3.1 高频单电机命令测试

| 频率(次/秒) | 持续时间 | 总命令数 | 成功数 | 失败数 | 成功率(%) | 平均延迟(ms) | 最大延迟(ms) | FIFO溢出 | 结果 |
|-------------|----------|----------|--------|--------|-----------|--------------|--------------|----------|------|
| 10 | 1min | | | | | | | | ☐Pass<br>☐Fail |
| 20 | 1min | | | | | | | | ☐Pass<br>☐Fail |
| 50 | 1min | | | | | | | | ☐Pass<br>☐Fail |
| 75 | 1min | | | | | | | | ☐Pass<br>☐Fail |
| 100 | 10min | | | | | | | | ☐Pass<br>☐Fail |

**验收结论**: ☐通过 ☐不通过  
**备注**: _______________________________________________

### T7.3.2 突发流量测试

| 测试轮次 | 突发数量 | 接收数量 | 丢包数量 | 丢包率(%) | FIFO溢出次数 | 系统状态 | 结果 |
|----------|----------|----------|----------|-----------|--------------|----------|------|
| 1 | 500 | | | | | ☐正常<br>☐卡顿<br>☐崩溃 | ☐Pass<br>☐Fail |
| 2 | 500 | | | | | ☐正常<br>☐卡顿<br>☐崩溃 | ☐Pass<br>☐Fail |
| 3 | 500 | | | | | ☐正常<br>☐卡顿<br>☐崩溃 | ☐Pass<br>☐Fail |

**验收结论**: ☐通过 ☐不通过  
**备注**: _______________________________________________

### T7.3.3 多电机并发控制测试

**测试配置**:
- 电机数量: ☐2 ☐3 ☐4 ☐5-8
- 每电机频率: _____次/秒
- 总频率: _____次/秒
- 测试时长: _____分钟

| 电机地址 | 总命令数 | 成功数 | 失败数 | 成功率(%) | 备注 |
|----------|----------|--------|--------|-----------|------|
| 0x01 | | | | | |
| 0x02 | | | | | |
| 0x03 | | | | | |
| 0x04 | | | | | |
| **汇总** | | | | | |

**同步运动测试**:
| 测试轮次 | 同步电机数 | 同步误差(ms) | 结果 |
|----------|------------|--------------|------|
| 1 | | | ☐Pass ☐Fail |
| 2 | | | ☐Pass ☐Fail |
| 3 | | | ☐Pass ☐Fail |

**验收结论**: ☐通过 ☐不通过  
**备注**: _______________________________________________

### T7.3.4 混合命令压力测试

| 命令类型 | 占比(%) | 发送次数 | 成功次数 | 平均延迟(ms) |
|----------|---------|----------|----------|--------------|
| 位置命令 | 40 | | | |
| 速度命令 | 30 | | | |
| 停止命令 | 10 | | | |
| 使能命令 | 10 | | | |
| 查询命令 | 10 | | | |
| **总计** | 100 | | | |

**整体统计**:
- 测试时长: _____分钟
- 总命令数: ___________
- 成功率: ___________%
- 平均延迟: _____ms
- 最大延迟: _____ms

**验收结论**: ☐通过 ☐不通过  
**备注**: _______________________________________________

### T7.3.6 错误帧注入测试

| 错误类型 | 注入数量 | 检测数量 | 检测率(%) | 误判数量 | 系统崩溃 | 结果 |
|----------|----------|----------|-----------|----------|----------|------|
| CRC错误 | | | | | ☐是 ☐否 | ☐Pass<br>☐Fail |
| 长度错误 | | | | | ☐是 ☐否 | ☐Pass<br>☐Fail |
| 地址错误 | | | | | ☐是 ☐否 | ☐Pass<br>☐Fail |
| 命令码错误 | | | | | ☐是 ☐否 | ☐Pass<br>☐Fail |
| 混合错误(5%) | | | | | ☐是 ☐否 | ☐Pass<br>☐Fail |

**验收结论**: ☐通过 ☐不通过  
**备注**: _______________________________________________

---

## 📈 综合评分与分析

### Phase 7 总体评分表

| 测试模块 | 权重 | P0项通过率 | P1项通过率 | 模块得分 | 备注 |
|----------|------|------------|------------|----------|------|
| T7.1 长时间运行 | 40% | ____/____=___% | ____/____=___% | ____ | |
| T7.2 故障注入 | 30% | ____/____=___% | ____/____=___% | ____ | |
| T7.3 通信压力 | 30% | ____/____=___% | ____/____=___% | ____ | |
| **总计** | 100% | - | - | **____** | |

**评分标准**:
- 模块得分 = (P0通过率 × 0.7 + P1通过率 × 0.3) × 权重
- 总分≥95: 优秀，可直接发布
- 总分90-94: 良好，建议优化
- 总分80-89: 合格，需优化后回归测试
- 总分<80: 不合格，需重大修复

### 关键指标汇总

| 指标类别 | 指标项 | 目标值 | 实测值 | 达标情况 |
|----------|--------|--------|--------|----------|
| **稳定性** | 48h无崩溃 | 是 | ☐是 ☐否 | ☐达标 ☐不达标 |
|  | 看门狗复位次数 | ≤5次 | ____次 | ☐达标 ☐不达标 |
|  | 电机失步次数 | 0次 | ____次 | ☐达标 ☐不达标 |
| **通信性能** | 通信成功率 | ≥99.9% | ____% | ☐达标 ☐不达标 |
|  | 平均响应延迟 | <10ms | ____ms | ☐达标 ☐不达标 |
|  | 最大响应延迟 | <50ms | ____ms | ☐达标 ☐不达标 |
| **容错性** | 电源跌落恢复 | 通过 | ☐通过 ☐不通过 | ☐达标 ☐不达标 |
|  | 通信断线恢复 | 通过 | ☐通过 ☐不通过 | ☐达标 ☐不达标 |
|  | 堵转保护 | 通过 | ☐通过 ☐不通过 | ☐达标 ☐不达标 |
| **压力性能** | 高频命令(100Hz) | 通过 | ☐通过 ☐不通过 | ☐达标 ☐不达标 |
|  | 多电机并发 | 通过 | ☐通过 ☐不通过 | ☐达标 ☐不达标 |

### 问题汇总表

| 问题ID | 严重级别 | 问题描述 | 复现步骤 | 发现时间 | 状态 | 解决方案 |
|--------|----------|----------|----------|----------|------|----------|
| BUG-001 | ☐P0 ☐P1 ☐P2 | | | | ☐待修复<br>☐已修复<br>☐已验证 | |
| BUG-002 | ☐P0 ☐P1 ☐P2 | | | | ☐待修复<br>☐已修复<br>☐已验证 | |
| BUG-003 | ☐P0 ☐P1 ☐P2 | | | | ☐待修复<br>☐已修复<br>☐已验证 | |

**严重级别定义**:
- **P0**: 系统崩溃、数据丢失、硬件损坏（阻塞发布）
- **P1**: 功能不可用、性能严重下降（影响发布）
- **P2**: 轻微缺陷、性能可优化（不影响发布）

---

## 📸 测试照片记录

**请拍摄以下场景并附在测试报告中**:

- [ ] 测试环境全景照片
- [ ] 硬件连接细节照片
- [ ] 示波器波形截图（RS485信号）
- [ ] 串口日志截图（关键统计信息）
- [ ] 异常现象照片（如有）
- [ ] 温度测量照片

**照片命名规范**: `YYYYMMDD_HHMM_TestID_Description.jpg`

---

## 📄 测试报告模板

### Phase 7 硬件验证测试报告

**报告编号**: TR-2025-STM32485-P7  
**报告日期**: ___年___月___日  
**测试周期**: ___年___月___日 ~ ___年___月___日  
**报告撰写**: ________________  
**报告审核**: ________________

#### 1. 测试概述

**项目背景**:
_________________________________________________________________
_________________________________________________________________

**测试目标**:
_________________________________________________________________
_________________________________________________________________

**测试范围**:
- ☐ 48小时长时间运行测试
- ☐ 故障注入测试
- ☐ 通信压力测试
- ☐ 其他: _______________

#### 2. 测试环境

**硬件配置**: (参考前文"测试环境记录表")

**软件版本**:
- 固件版本: _______________
- 工具链版本: _______________
- 测试工具版本: _______________

#### 3. 测试结果汇总

**整体评分**: _____/100

**通过率统计**:
- P0级别测试项: ____/____  通过率_____%
- P1级别测试项: ____/____  通过率_____%
- P2级别测试项: ____/____  通过率_____%

**关键指标达标情况**:
| 指标 | 目标 | 实测 | 达标 |
|------|------|------|------|
| 系统稳定性 | 48h无崩溃 | | ☐是 ☐否 |
| 通信成功率 | ≥99.9% | ____% | ☐是 ☐否 |
| 响应延迟 | <10ms | ____ms | ☐是 ☐否 |

#### 4. 详细测试结果

(参考前文各测试项的数据表格)

#### 5. 问题与风险

**发现的问题**:
1. ___________________________________________________________
2. ___________________________________________________________
3. ___________________________________________________________

**遗留风险**:
1. ___________________________________________________________
2. ___________________________________________________________

#### 6. 结论与建议

**测试结论**: ☐通过 ☐有条件通过 ☐不通过

**改进建议**:
1. ___________________________________________________________
2. ___________________________________________________________
3. ___________________________________________________________

**后续计划**:
1. ___________________________________________________________
2. ___________________________________________________________

#### 7. 附件清单

- [ ] 完整测试日志文件
- [ ] 测试照片集
- [ ] 数据分析图表
- [ ] 异常情况说明文档

---

**报告撰写人**: __________ 日期: __________

**报告审核人**: __________ 日期: __________

---

## 📊 数据可视化建议

### Excel图表模板

建议使用Excel制作以下图表，直观展示测试结果：

1. **48小时运行曲线图**
   - X轴: 运行时间（小时）
   - Y轴: 通信成功率（%）
   - 折线图，展示成功率变化趋势

2. **响应延迟分布直方图**
   - X轴: 延迟区间（0-5ms, 5-10ms, 10-20ms, >20ms）
   - Y轴: 频次
   - 柱状图

3. **多电机负载对比图**
   - X轴: 电机地址
   - Y轴: 命令数量/成功率
   - 簇状柱状图

4. **温度变化曲线**
   - X轴: 时间
   - Y轴: 温度（°C）
   - 多条折线（STM32温度、电机温度、环境温度）

5. **故障注入结果雷达图**
   - 维度: 电源跌落、通信断线、堵转保护、看门狗、错误帧
   - 值: 恢复时间（归一化）

---

## ✅ 测试交付清单

在宣布Phase 7完成前，请确认以下所有文件已准备就绪：

- [ ] 测试环境记录表（已填写）
- [ ] T7.1 长时间运行测试记录（已填写）
- [ ] T7.2 故障注入测试记录（已填写）
- [ ] T7.3 通信压力测试记录（已填写）
- [ ] 综合评分与分析表（已填写）
- [ ] 问题汇总表（已填写）
- [ ] 测试照片集（已整理）
- [ ] 完整日志文件（已备份）
- [ ] 测试报告（已撰写并审核）
- [ ] 改进建议文档（已编写）
- [ ] 数据分析图表（Excel文件）

---

**文档结束 | 请根据实际测试情况填写相应表格**

*建议将此文档复制到Excel中使用，便于数据录入和图表生成*
